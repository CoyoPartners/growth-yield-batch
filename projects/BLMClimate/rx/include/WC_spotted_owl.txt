COMMENT
Compute variables used in Northern spotted owl suitability rating.
Diameter Diversity Index from McComb, McGrath, Spies, and Vesely (2000) 
and Franklin, Spies, and Van Pelt (2005).  Other variables defined by
2011 Revised Recovery Plan for NSO, converted to English units.
END
IF
EVPHASE EQ 2
THEN
AGPLABEL
All
COMPUTE            0
DDI = LININT(SPMCDBH(1,All,0,2,9.8),0,81,81,0,1,1) + &
2*LININT(SPMCDBH(1,All,0,9.8,19.7),0,30,30,0,1,1) + &
3*LININT(SPMCDBH(1,All,0,19.7,39.4),0,16,16,0,1,1) + &
4*LININT(SPMCDBH(1,All,0,39.4),0,12,12,0,1,1)
END
ENDIF
IF
EVPHASE EQ 2 AND SPMCDBH(2,CONSPP,0) GT 0
THEN
AGPLABEL
ALL
COMPUTE            0
BAxDBH_C = ((SPMCDBH(2,CONSPP,0,0,5)*SPMCDBH(5,CONSPP,0,0,5))&
+(SPMCDBH(2,CONSPP,0,5,10)*SPMCDBH(5,CONSPP,0,5,10))&
+(SPMCDBH(2,CONSPP,0,10,15)*SPMCDBH(5,CONSPP,0,10,15))&
+(SPMCDBH(2,CONSPP,0,15,20)*SPMCDBH(5,CONSPP,0,15,20))&
+(SPMCDBH(2,CONSPP,0,20,25)*SPMCDBH(5,CONSPP,0,20,25))&
+(SPMCDBH(2,CONSPP,0,25,30)*SPMCDBH(5,CONSPP,0,25,30))&
+(SPMCDBH(2,CONSPP,0,30)*SPMCDBH(5,CONSPP,0,30)))/&
SPMCDBH(2,CONSPP,0)
END
ENDIF
IF
EVPHASE EQ 2 AND SPMCDBH(2,CONSPP,0) EQ 0
THEN
AGPLABEL
ALL
COMPUTE            0
BAxDBH_C = 0
END
ENDIF

COMMENT
Compute Suitability for Northern Spotted Owl.  Includes ratings for 
Nesting/Roosting (NSONEST), Foraging (NSOFRG), and Dispersal (NSODIS).
Stands are rated suitable if they satisfy thresholds for the Northern,
Central, or Southern ranges of the Western Cascades from 2011 Revised 
NSO Recovery Plan. 
Ratings for NSONEST, NSOFRG, and NSODIS:
0 = not suitable
1 = suitable
END
IF
EVPHASE EQ 2
THEN
AGPLABEL
All
COMPUTE            0
NSONESTN = LININT(LININT(ACANCOV,80,80,0,1)+LININT(BAxDBH_C,23.6,23.6,0,1)&
+LININT(SPMCDBH(1,CONSPP,0,39.4),2.8,2.8,0,1),3,3,0,1)
NSONESTC = LININT(LININT(SPMCDBH(1,All,0,19.7),25.9,25.9,0,1)&
+LININT(SPMCDBH(1,All,0,29.5),6.5,6.5,0,1)&
+LININT(SPMCDBH(1,CONSPP,0,39.4),1.6,1.6,0,1),3,3,0,1)
NSONESTS = LININT(LININT(ACANCOV,70,70,0,1)+LININT(BAxDBH_C,19.7,19.7,0,1)&
+LININT(SPMCDBH(1,All,0,29.5),8.9,8.9,0,1),3,3,0,1)
NSONEST = LININT(NSONESTN+NSONESTC+NSONESTS,1,1,0,1)
NSOFRGN = LININT(LININT(ACANCOV,70,70,0,1)+&
LININT(DDI,5,5,0,1)+LININT(SPMCDBH(1,All,0,19.7),17,17,0,1)+&
LININT(SPMCDBH(2,All,0,1.2),174,174,0,1),4,4,0,1)
NSOFRGC = LININT(LININT(ACANCOV,70,70,0,1)+&
LININT(DDI,4,4,0,1)+LININT(SPMCDBH(1,All,0,19.7),15,15,0,1)+&
LININT(SPMCDBH(2,All,0,1.2),161,161,0,1),4,4,0,1)
NSOFRGS = LININT(LININT(ACANCOV,60,60,0,1)+LININT(DDI,4,4,0,1)&
+LININT(SPMCDBH(5,CONSPP,0,ASTRDBH,999),14.6,14.6,0,1),3,3,0,1)
NSOFRG = LININT(NSOFRGN+NSOFRGC+NSOFRGS+NSONEST,1,1,0,1)
NSODIS = LININT(LININT(LININT(SPMCDBH(5,All,0),11,11,0,1)&
+LININT(SPMCDBH(7,CONSPP,0),0.3,0.3,0,1),2,2,0,1)+NSOFRG+NSONEST,1,1,0,1)
END
ENDIF