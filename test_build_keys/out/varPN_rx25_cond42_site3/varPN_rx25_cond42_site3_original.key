SCREEN
STATS
STDIDENT
S00999        IDB Plot Number
STDINFO                               10          0         0         5
DESIGN            -1         1
INVYEAR         2013
TimeInt                      5
NUMCYCLE          20
TREEFMT
(I4,T1,I8,F6.0,I1,A3,F5.1,F3.1,F3.0,F3.0,F4.1,I1,6I2,I1,I1,I2,I3,I3,I1,I1,F3.0)
TREEDATA          50
OPEN              50
42.fvs
TREEDATA          50
Treelist          0.                   1
Treelist          0.                   1                   1
Cutlist           0.                   1
ATRTLIST          0.                   1
StrClass           1

COMMENT
Override default site index. Corresponds to Site Class II for PN, WC, and NC
variants.
END
SiteCode          DF       145         1

COMMENT
Define "Offset" value, should be 0 or in multiples of 5 (cycle length).
END
Compute
Offset = 0
End

COMMENT
Determine the year in which repeated commercial thinnings commence (REGENYR).
END
IF               999
BSDI GE 0.35*BSDIMAX
THEN
AGPLABEL
All
Compute
CYC1 = CYCLE
END
ENDIF
IF               999
AGE GE 30 AND CYCLE LE CYC1
THEN
AGPLABEL
All
Compute
REGENYR = YEAR + OFFSET
END
ENDIF
IF               999
AGE LT 30 AND CYCLE LE CYC1
THEN 
AGPLABEL
All
Compute
REGENYR = (30 + OFFSET - AGE) + YEAR
END

COMMENT
Create Fire and Fuels Extension Reports, compute Fire Hazard Rating.
Fire Hazard ratings based on Hugget, Abt, and Shepperd (2008):
0 = very low risk
1 = low risk
2 = medium risk
3 = medium-high risk
4 = high risk
END
FMIn    
Potfire                                5
FuelOut                                5 
SnagSum   
End
IF
EVPHASE EQ 2
THEN
AGPLABEL
All
Compute         0
FIREHZD = BOUND(0,LININT(TORCHIDX,25,25,2,0) + &
LININT(CROWNIDX,25,25,40,40,3,0,0,-1),4)
End
ENDIF

COMMENT
Create Carbon Reports with units of metric tonnes C per acre.
END
FMIn    
CarbRept                               5
CarbCut                                5   
CarbCalc           0         2
End

COMMENT
Define conifers as a species group.  PN variant.
END
SPGROUP       CONSPP
AF DF ES GF IC JP KP LL LP MH NF PP PY RC RF RW SF SP SS WB WF WH WJ WP YC

COMMENT
Compute variables used in Northern spotted owl suitability rating.
Diameter Diversity Index from McComb, McGrath, Spies, and Vesely (2000) 
and Franklin, Spies, and Van Pelt (2005).  Other variables defined by
2011 Revised Recovery Plan for NSO, converted to English units.
END
IF
EVPHASE EQ 2
THEN
AGPLABEL
All
Compute            0
DDI = LININT(SPMCDBH(1,All,0,2,9.8),0,119,0,1) + &
2*LININT(SPMCDBH(1,All,0,9.8,19.7),0,35,0,1) + &
3*LININT(SPMCDBH(1,All,0,19.7,39.4),0,28,0,1) + &
4*LININT(SPMCDBH(1,All,0,39.4),0,11,0,1)
BAxDBH_C = (&
 (SPMCDBH(2,CONSPP,0, 0, 5)*SPMCDBH(5,CONSPP,0, 0, 5))&
+(SPMCDBH(2,CONSPP,0, 5,10)*SPMCDBH(5,CONSPP,0, 5,10))&
+(SPMCDBH(2,CONSPP,0,10,15)*SPMCDBH(5,CONSPP,0,10,15))&
+(SPMCDBH(2,CONSPP,0,15,20)*SPMCDBH(5,CONSPP,0,15,20))&
+(SPMCDBH(2,CONSPP,0,20,25)*SPMCDBH(5,CONSPP,0,20,25))&
+(SPMCDBH(2,CONSPP,0,25,30)*SPMCDBH(5,CONSPP,0,25,30))&
+(SPMCDBH(2,CONSPP,0,30)*SPMCDBH(5,CONSPP,0,30)))/&
SPMCDBH(2,CONSPP,0)
CANCOV_C = SPMCDBH(7,CONSPP,0)
TPAGE19 = SPMCDBH(1,All,0,19.7)
TPAGE29 = SPMCDBH(1,All,0,29.5)
BAAGE1 = SPMCDBH(2,All,0,1.2)
END
ENDIF

COMMENT
Compute Suitability for Northern Spotted Owl.  Includes ratings for 
Nesting/Roosting (NSONEST), Foraging (NSOFRG), and Dispersal (NSODIS).
Stands are rated suitable if they satisfy North Coast/Olympics OR
Oregon Coast thresholds from 2011 Revised NSO Recovery Plan. 
Ratings for NSONEST, NSOFRG, and NSODIS:
0 = not suitable
1 = suitable
END
IF
EVPHASE EQ 2
THEN
AGPLABEL
All
Compute            0
NSONESTN = LININT(LININT(DDI,6,6,0,1)+LININT(TPAGE29,10.1,10.1,0,1)&
+LININT(BAAGE1,240,240,0,1),3,3,0,1)
NSONESTS = LININT(LININT(CANCOV_C,65,65,0,1)+LININT(DDI,6,6,0,1)&
+LININT(TPAGE29,8.1,8.1,0,1),3,3,0,1)
NSONEST = LININT(NSONESTN+NSONESTS,1,1,0,1)
NSOFRGN = LININT(LININT(BAxDBH_C,15.7,15.7,0,1)+&
LININT(TPAGE29,4,4,0,1),2,2,0,1)
NSOFRGS = LININT(LININT(DDI,4,4,0,1)+&
LININT(TPAGE19,12.1,12.1,0,1),2,2,0,1)
NSOFRG = LININT(NSOFRGN+NSOFRGS+NSONEST,1,1,0,1)
NSODIS = LININT(LININT(LININT(SPMCDBH(5,All,0),11,11,0,1)&
+LININT(CANCOV_C,0.3,0.3,0,1),2,2,0,1)+NSOFRG+NSONEST,1,1,0,1)
END
ENDIF

COMMENT
Compute susceptibility ratings for Mountain Pine Beetle in Ponderosa Pine
(PP_BTL) and Lodgepole Pine (LP_BTL). Ratings for PP_BTL, based on Munson
and Anhold (1995) and described in User's Guide to the Post-Processors 
for the Forest Vegetation Simulator (Van Dyck 2005):
3-4  = Low
5-8  = Moderate
9-11 = High
Ratings for LP_BTL, based on Randall and Tensmeyer (2000):
1    = Extremely low
2-7  = Low
8-13 = Moderate
14   = High
END
IF
EVPHASE EQ 2
THEN
AGPLABEL
All
Compute            0
PP_BTL = LININT(SPMCDBH(5,PP,0,5,999),6,6,12,12,1,2,2,3) + &
LININT(SPMCDBH(2,All,0,5,999),80,80,120,120,1,2,2,3) + &
LININT(SPMCDBH(1,PP,0,0,999,0.75*ATOPHT,999)/&
SPMCDBH(1,All,0,0,999,0.75*ATOPHT,999),0.5,0.5,0.65,0.65,1,2,2,3)
LP_BTL = MIN(LININT(SPMCDBH(2,LP,0)/SPMCDBH(2,All,0),0.0001,0.0001,&
.25,.25,.5,.5,1,2,2,8,8,14),LININT(ABA,80,80,120,120,250,250,3,9,9,&
14,14,3),LININT(SPMCDBH(1,All,0,3),100,100,300,300,600,600,800,800,&
4,10,10,14,14,10,10,4),LININT(SPMCDBH(5,LP,0,5),6,6,8,8,5,11,11,14)&
,LININT(Age,60,80,7,13,13,14))
END
ENDIF

COMMENT
Compute a susceptibility rating for spruce beetle outbreak in 
Englemann Spruce.  Ratings for ES_BTL, based on Schmid and Frye 
(1976) and described in User's Guide to Post-Processors for the
Forest Vegetation Simulator (Van Dyck 2005):
4-5   = LOW
6     = LOW-MODERATE
7-9   = MODERATE
10    = MODERATE-HIGH
11-12 = HIGH
END
IF
EVPHASE EQ 2
THEN
AGPLABEL
All
COMPUTE            0
ES_BTL = LININT(SITE,80,80,1,2)+ LININT(SPMCDBH(5,ES,0,10,999)&
,12,12,16,16,1,2,2,3) + LININT(ABA,100,100,150,150,1,2,2,3) +&
 LININT((SPMCDBH(1,ES,0,0,999,0.75*ATOPHT,999)&
/SPMCDBH(1,All,0,0,999,0.75*ATOPHT,999)),0.5,0.5,0.65,0.65,1,2,2,3)
END
ENDIF

COMMENT
Simulate thin throughout diameter distribution to 35% of maximum SDI 
every 20 years beginning at age 30.
Lower Level of Management Zone is ~40% of maximum SDI.
END
If                20
AGE GE 30 AND YEAR GE REGENYR
Then
AGPLABEL
All
ESTAB
NOSPROUT
END
ThinSDI            0     Parms(0.35*BSDIMAX, 1., All, 0., 999., 0)
ENDIF

COMMENT
Simulate pre-commercial thin to 280 TPA at Age 15-20
END
If               999
Year GE (REGENYR - 15) and Age GE 15
Then 
AGPLABEL
All
ESTAB
NOSPROUT
END
thinBTA            0      280.        1.        0.      999.        0.      999.
Endif

COMMENT
Trigger natural regeneration when >10% of canopy removed. 
Regeneration based on pre-cut TPA >5" by species. PN Variant.
END
If
(ACANCOV)/(BCANCOV)*(100) LT 90
Then
AGPLABEL
All
ESTAB
Natural            1    Parms(SF, SpMcDbh(1,SF,0,5,999) +&
SpMcDbh(1,SF,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(WF, SpMcDbh(1,WF,0,5,999) +&
SpMcDbh(1,WF,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(GF, SpMcDbh(1,GF,0,5,999) +&
SpMcDbh(1,GF,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(AF, SpMcDbh(1,AF,0,5,999) +&
SpMcDbh(1,AF,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(RF, SpMcDbh(1,RF,0,5,999) +&
SpMcDbh(1,RF,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(SS, SpMcDbh(1,SS,0,5,999) +&
SpMcDbh(1,SS,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(NF, SpMcDbh(1,NF,0,5,999) +&
SpMcDbh(1,NF,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(YC, SpMcDbh(1,YC,0,5,999) +&
SpMcDbh(1,YC,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(IC, SpMcDbh(1,IC,0,5,999) +&
SpMcDbh(1,IC,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(ES, SpMcDbh(1,ES,0,5,999) +&
SpMcDbh(1,ES,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(LP, SpMcDbh(1,LP,0,5,999) +&
SpMcDbh(1,LP,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(JP, SpMcDbh(1,JP,0,5,999) +&
SpMcDbh(1,JP,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(SP, SpMcDbh(1,SP,0,5,999) +&
SpMcDbh(1,SP,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(WP, SpMcDbh(1,WP,0,5,999) +&
SpMcDbh(1,WP,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(PP, SpMcDbh(1,PP,0,5,999) +&
SpMcDbh(1,PP,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(DF, SpMcDbh(1,DF,0,5,999) +&
SpMcDbh(1,DF,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(RW, SpMcDbh(1,RW,0,5,999) +&
SpMcDbh(1,RW,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(RC, SpMcDbh(1,RC,0,5,999) +&
SpMcDbh(1,RC,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(WH, SpMcDbh(1,WH,0,5,999) +&
SpMcDbh(1,WH,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(MH, SpMcDbh(1,MH,0,5,999) +&
SpMcDbh(1,MH,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(BM, SpMcDbh(1,BM,0,5,999) +&
SpMcDbh(1,BM,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(RA, SpMcDbh(1,RA,0,5,999) +&
SpMcDbh(1,RA,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(WA, SpMcDbh(1,WA,0,5,999) +&
SpMcDbh(1,WA,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(PB, SpMcDbh(1,PB,0,5,999) +&
SpMcDbh(1,PB,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(GC, SpMcDbh(1,GC,0,5,999) +&
SpMcDbh(1,GC,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(AS, SpMcDbh(1,AS,0,5,999) +&
SpMcDbh(1,AS,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(CW, SpMcDbh(1,CW,0,5,999) +&
SpMcDbh(1,CW,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(WO, SpMcDbh(1,WO,0,5,999) +&
SpMcDbh(1,WO,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(WJ, SpMcDbh(1,WJ,0,5,999) +&
SpMcDbh(1,WJ,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(LL, SpMcDbh(1,LL,0,5,999) +&
SpMcDbh(1,LL,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(WB, SpMcDbh(1,WB,0,5,999) +&
SpMcDbh(1,WB,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(KP, SpMcDbh(1,KP,0,5,999) +&
SpMcDbh(1,KP,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(PY, SpMcDbh(1,PY,0,5,999) +&
SpMcDbh(1,PY,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(DG, SpMcDbh(1,DG,0,5,999) +&
SpMcDbh(1,DG,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(HT, SpMcDbh(1,HT,0,5,999) +&
SpMcDbh(1,HT,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(CH, SpMcDbh(1,CH,0,5,999) +&
SpMcDbh(1,CH,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(WI, SpMcDbh(1,WI,0,5,999) +&
SpMcDbh(1,WI,0,5,999,0,999,2), 100., 2., 0.5, 0)
Natural            1    Parms(OT, SpMcDbh(1,OT,0,5,999) +&
SpMcDbh(1,OT,0,5,999,0,999,2), 100., 2., 0.5, 0)
End
Endif

PROCESS
CLOSE             50
STOP